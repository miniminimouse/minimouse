%macro CPSI_One_Cut(dev_data=, oot_data=, var=, model=);

    /* grab total count from baseline dataset */
    proc sql;
        create table work.totalz as
        select count(*) as No_Obsv
        from work.&dev_data.;
    quit;

    /* store it for percentage calculations */
    data _null_;
        set work.totalz;
        call symput('ETotal', No_Obsv);
    run;

    /* baseline distribution percentages */
    proc sql;
        create table work.Expected_values as
        select distinct &var.,
            (count(*)/&ETotal.)*100 as Expected_Percent
        from work.&dev_data.
        group by &var.;
    quit;

    /* same thing for current data */
    proc sql;
        create table work.totalz as
        select count(*) as No_Obsv
        from work.&oot_data.;
    quit;

    data _null_;
        set work.totalz;
        call symput('ATotal', No_Obsv);
    run;

    /* current distribution percentages */
    proc sql;
        create table work.Actual_values as
        select distinct &var.,
            (count(*)/&ATotal.)*100 as Actual_Percent
        from work.&oot_data.
        group by &var.;
    quit;

    /* merge them together */
    data work.combined;
        merge work.Expected_values work.Actual_values;
        by &var.;  /* added by statement for proper merge */
    run;

    /* handle missing baseline percentages */
    data work.combined;
        set work.combined;
        if Expected_Percent=. then Expected_Percent=0;
    run;

    /* calculate the psi pieces */
    data work.combined_&model._&var.;
        set work.combined;
        PSI_Piece= (Actual_Percent-Expected_Percent)*log(((Actual_Percent+.5)/(Expected_Percent+.5)))/100;
    run;

%mend CPSI_One_Cut;
